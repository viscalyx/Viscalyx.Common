[System.Diagnostics.CodeAnalysis.SuppressMessageAttribute('PSUseDeclaredVarsMoreThanAssignments', '')]
param ()

# ----
# NOTE! This file must be UTF with BOM for the unicode test to work.
# ----

BeforeDiscovery {
    try
    {
        if (-not (Get-Module -Name 'DscResource.Test'))
        {
            # Assumes dependencies has been resolved, so if this module is not available, run 'noop' task.
            if (-not (Get-Module -Name 'DscResource.Test' -ListAvailable))
            {
                # Redirect all streams to $null, except the error stream (stream 2)
                & "$PSScriptRoot/../../../build.ps1" -Tasks 'noop' 2>&1 4>&1 5>&1 6>&1 > $null
            }

            # If the dependencies has not been resolved, this will throw an error.
            Import-Module -Name 'DscResource.Test' -Force -ErrorAction 'Stop'
        }
    }
    catch [System.IO.FileNotFoundException]
    {
        throw 'DscResource.Test module dependency not found. Please run ".\build.ps1 -ResolveDependency -Tasks build" first.'
    }
}

BeforeAll {
    $script:dscModuleName = 'Viscalyx.Common'

    Import-Module -Name $script:dscModuleName

    $PSDefaultParameterValues['InModuleScope:ModuleName'] = $script:dscModuleName
    $PSDefaultParameterValues['Mock:ModuleName'] = $script:dscModuleName
    $PSDefaultParameterValues['Should:ModuleName'] = $script:dscModuleName
}

AfterAll {
    $PSDefaultParameterValues.Remove('InModuleScope:ModuleName')
    $PSDefaultParameterValues.Remove('Mock:ModuleName')
    $PSDefaultParameterValues.Remove('Should:ModuleName')

    # Unload the module being tested so that it doesn't impact any other tests.
    Get-Module -Name $script:dscModuleName -All | Remove-Module -Force
}

Describe 'Out-Difference' {
    # cSpell: disable
    Context 'When there are multiple lines' {
        It 'Should output to console' {
            $expected = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )
            $actual = @(
                'My string that is shorter'
                'Line 2'
                'Line 3 is longer than expected'
                'Line 4'
            )

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "4D 79 20 $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m   !=   4D 79 20 $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m           "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "4C 69 6E 65 20 32                               Line 2             ==   4C 69 6E 65 20 32                               Line 2          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m     !=   $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m78$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m70$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m64$([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mx$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mp$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31md$([System.Char] 0x1b)[0m  "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m34$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m4$([System.Char] 0x1b)[0m          "
            )
        }

        It 'Should output to console, but without column header' {
            $expected = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )
            $actual = @(
                'My string that is shorter'
                'Line 2'
                'Line 3 is longer than expected'
                'Line 4'
            )

            $result = Out-Difference -Reference $expected -Difference $actual -NoColumnHeader

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "4D 79 20 $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m   !=   4D 79 20 $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m           "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "4C 69 6E 65 20 32                               Line 2             ==   4C 69 6E 65 20 32                               Line 2          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m     !=   $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m78$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m70$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m64$([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mx$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mp$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31md$([System.Char] 0x1b)[0m  "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m34$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m4$([System.Char] 0x1b)[0m          "
            )
        }

        It 'Should output to console, but without labels' {
            $expected = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )
            $actual = @(
                'My string that is shorter'
                'Line 2'
                'Line 3 is longer than expected'
                'Line 4'
            )

            $result = Out-Difference -Reference $expected -Difference $actual -NoLabels

            $result | Should-BeBlockString @(
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "4D 79 20 $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m   !=   4D 79 20 $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m           "
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "4C 69 6E 65 20 32                               Line 2             ==   4C 69 6E 65 20 32                               Line 2          "
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m     !=   $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m78$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m70$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m64$([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mx$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mp$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31md$([System.Char] 0x1b)[0m  "
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m34$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m4$([System.Char] 0x1b)[0m          "
            )
        }

        It 'Should output to console, but without column header and labels' {
            $expected = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )

            $actual = @(
                'My string that is shorter'
                'Line 2'
                'Line 3 is longer than expected'
                'Line 4'
            )

            $result = Out-Difference -Reference $expected -Difference $actual -NoColumnHeader -NoLabels

            $result | Should-BeBlockString @(
                "4D 79 20 $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m   !=   4D 79 20 $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m 74 72 69 6E 67 20 $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m 20 $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m My $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0mtring $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m           "
                "4C 69 6E 65 20 32                               Line 2             ==   4C 69 6E 65 20 32                               Line 2          "
                "4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   4C 69 6E 65 20 33 $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m Line 3$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m     !=   $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m78$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m70$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m64$([System.Char] 0x1b)[0m       $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mx$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mp$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31md$([System.Char] 0x1b)[0m  "
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m34$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m4$([System.Char] 0x1b)[0m          "
            )
        }
    }

    Context 'When actual value is an empty value' {
        It 'Should output to console' {
            $expected = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )
            $actual = ''

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m4D$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mM$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m           "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m32$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m2$([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m33$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m3$([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m          "
            )
        }
    }

    Context 'When actual value is null' {
        It 'Should output to console' {
            $expected = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )
            $actual = $null

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m4D$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mM$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m           "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m32$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m2$([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m33$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m3$([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m          "
            )
        }
    }

    Context 'When expected value is an empty value' {
        It 'Should output to console' {
            $expected = ''
            $actual = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m4D$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mM$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m           "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m32$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m2$([System.Char] 0x1b)[0m          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m33$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m3$([System.Char] 0x1b)[0m          "
            )
        }
    }

    Context 'When expected value is null' {
        It 'Should output to console' {
            $expected = $null
            $actual = @(
                'My String very long string that is longer than actual'
                'Line 2'
                'Line 3'
            )

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m4D$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m53$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m76$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m79$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mM$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mS$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mv$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31my$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m              !=   $([System.Char] 0x1b)[31m63$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m                                  $([System.Char] 0x1b)[31mc$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m           "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m32$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m2$([System.Char] 0x1b)[0m          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m4C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m33$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31mL$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m3$([System.Char] 0x1b)[0m          "
            )
        }
    }

    Context 'When expected and actual value is null' {
        It 'Should output to console' {
            $expected = $null
            $actual = $null

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeEquivalent @()
        }
    }

    Context 'When expected and actual value is both an empty string' {
        It 'Should output to console' {
            $expected = ''
            $actual = ''

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
            )
        }
    }

    Context 'When expected and actual value is a single string' {
        Context 'When expected and actual value is the same' {
            It 'Should output to console' {
                $expected = 'This is a test'
                $actual = 'This is a test'

                $result = Out-Difference -Reference $expected -Difference $actual -EqualIndicator '='

                $result | Should-BeBlockString @(
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "54 68 69 73 20 69 73 20 61 20 74 65 73 74       This is a test     =    54 68 69 73 20 69 73 20 61 20 74 65 73 74       This is a test  "
                )
            }
        }

        Context 'When expected and actual value is different' {
            It 'Should output to console' {
                $expected = 'This is a test'
                $actual = 'This is another test'

                $result = Out-Difference -Reference $expected -Difference $actual -NotEqualIndicator '!'

                $result | Should-BeBlockString @(
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "54 68 69 73 20 69 73 20 61 $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m This is a$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !    54 68 69 73 20 69 73 20 61 $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m This is a$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                    "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                                     $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m               !    $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m                                     $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m            "
                )
            }
        }

        Context 'When expected and actual value contain line breaks and new line' {
            It 'Should output to console' {
                $expected = "This is`r`na test"
                $actual = "This Is`r`nAnother`r`nTest"

                $result = Out-Difference -Reference $expected -Difference $actual

                $result | Should-BeBlockString @(
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "54 68 69 73 20 $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m 73 0D 0A $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m This $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0ms␍␊$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m   !=   54 68 69 73 20 $([System.Char] 0x1b)[31m49$([System.Char] 0x1b)[0m 73 0D 0A $([System.Char] 0x1b)[31m41$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m72$([System.Char] 0x1b)[0m This $([System.Char] 0x1b)[31mI$([System.Char] 0x1b)[0ms␍␊$([System.Char] 0x1b)[31mA$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mr$([System.Char] 0x1b)[0m"
                    "$([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m             !=   $([System.Char] 0x1b)[31m0D$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m0A$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m54$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m                               $([System.Char] 0x1b)[31m␍$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m␊$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mT$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m          "
                )
            }
        }

        Context 'When expected and actual value just different in case sensitivity' {
            It 'Should output to console' {
                $expected = @('Test','a','b')
                $actual = @('test','a','b')

                $result = Out-Difference -Reference $expected -Difference $actual

                $result | Should-BeBlockString @(
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "$([System.Char] 0x1b)[31m54$([System.Char] 0x1b)[0m 65 73 74                                     $([System.Char] 0x1b)[31mT$([System.Char] 0x1b)[0mest               !=   $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m 65 73 74                                     $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0mest            "
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "61                                              a                  ==   61                                              a               "
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "62                                              b                  ==   62                                              b               "
                )
            }
        }

        Context 'When concatenating string array' {
            It 'Should output to console' {
                $expected = @('Test','a','b')
                $actual = @('test','a','b')

                $result = Out-Difference -Reference $expected -Difference $actual -ConcatenateArray -ConcatenateChar ''

                $result | Should-BeBlockString @(
                    "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                    "----------------------------------------------------------------        ----------------------------------------------------------------"
                    "Bytes                                           Ascii                   Bytes                                           Ascii"
                    "-----                                           -----                   -----                                           -----"
                    "$([System.Char] 0x1b)[31m54$([System.Char] 0x1b)[0m 65 73 74 61 62                               $([System.Char] 0x1b)[31mT$([System.Char] 0x1b)[0mestab             !=   $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m 65 73 74 61 62                               $([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0mestab          "
                )
            }
        }
    }

    Context 'When expected and actual value have different lengths but similar content' {
        It 'Should output to console' {
            $expected = 'This is a test string that is quite long'
            $actual = 'This is a test string'

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "54 68 69 73 20 69 73 20 61 20 74 65 73 74 20 73 This is a test s   ==   54 68 69 73 20 69 73 20 61 20 74 65 73 74 20 73 This is a test s"
                "74 72 69 6E 67 $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m68$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m61$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m73$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m71$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m75$([System.Char] 0x1b)[0m tring$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mh$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ma$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ms$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mq$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mu$([System.Char] 0x1b)[0m   !=   74 72 69 6E 67 $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m tring$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m"
                "$([System.Char] 0x1b)[31m69$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m74$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m65$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m20$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6C$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6F$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m6E$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m67$([System.Char] 0x1b)[0m                         $([System.Char] 0x1b)[31mi$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mt$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31me$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31ml$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mo$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mn$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31mg$([System.Char] 0x1b)[0m           !=   $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m  $([System.Char] 0x1b)[0m                         $([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m $([System.Char] 0x1b)[0m        "
            )
        }
    }

    Context 'When expected and actual value contain special characters' {
        It 'Should output to console' {
            $expected = 'This is a test string with special characters: !@#$%^&*()'
            $actual = 'This is a test string with special characters: !@#$%^&*()'

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "54 68 69 73 20 69 73 20 61 20 74 65 73 74 20 73 This is a test s   ==   54 68 69 73 20 69 73 20 61 20 74 65 73 74 20 73 This is a test s"
                "74 72 69 6E 67 20 77 69 74 68 20 73 70 65 63 69 tring with speci   ==   74 72 69 6E 67 20 77 69 74 68 20 73 70 65 63 69 tring with speci"
                "61 6C 20 63 68 61 72 61 63 74 65 72 73 3A 20 21 al characters: !   ==   61 6C 20 63 68 61 72 61 63 74 65 72 73 3A 20 21 al characters: !"
                "40 23 24 25 5E 26 2A 28 29                      @#$%^&*()          ==   40 23 24 25 5E 26 2A 28 29                      @#$%^&*()       "
            )
        }
    }

    Context 'When expected and actual value are empty arrays' {
        It 'Should output to console' {
            $expected = @()
            $actual = @()

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeEquivalent @()
        }
    }

    Context 'When expected and actual value contain mixed content' {
        It 'Should output to console' {
            $expected = @('String', 123, 'Another String')
            $actual = @('String', 456, 'Another String')

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "53 74 72 69 6E 67                               String             ==   53 74 72 69 6E 67                               String          "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "$([System.Char] 0x1b)[31m31$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m32$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m33$([System.Char] 0x1b)[0m                                        $([System.Char] 0x1b)[31m1$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m2$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m3$([System.Char] 0x1b)[0m                !=   $([System.Char] 0x1b)[31m34$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m35$([System.Char] 0x1b)[0m $([System.Char] 0x1b)[31m36$([System.Char] 0x1b)[0m                                        $([System.Char] 0x1b)[31m4$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m5$([System.Char] 0x1b)[0m$([System.Char] 0x1b)[31m6$([System.Char] 0x1b)[0m             "
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "41 6E 6F 74 68 65 72 20 53 74 72 69 6E 67       Another String     ==   41 6E 6F 74 68 65 72 20 53 74 72 69 6E 67       Another String  "
            )
        }
    }

    Context 'When expected and actual value contain Unicode characters' -Skip:($PSEdition -eq 'Desktop') {
        It 'Should output to console' {
            $expected = 'This is a test string with Unicode: 你好, Привіт, hello' # cSpell: disable-line
            $actual = 'This is a test string with Unicode: 你好, Привіт, hello' # cSpell: disable-line

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "54 68 69 73 20 69 73 20 61 20 74 65 73 74 20 73 This is a test s   ==   54 68 69 73 20 69 73 20 61 20 74 65 73 74 20 73 This is a test s"
                "74 72 69 6E 67 20 77 69 74 68 20 55 6E 69 63 6F tring with Unico   ==   74 72 69 6E 67 20 77 69 74 68 20 55 6E 69 63 6F tring with Unico"
                "64 65 3A 20 E4 BD A0 E5 A5 BD 2C 20 D0 9F D1 80 de: ä½ å¥½, ÐÑ   ==   64 65 3A 20 E4 BD A0 E5 A5 BD 2C 20 D0 9F D1 80 de: ä½ å¥½, ÐÑ"
                "D0 B8 D0 B2 D1 96 D1 82 2C 20 68 65 6C 6C 6F    Ð¸Ð²ÑÑ, hello    ==   D0 B8 D0 B2 D1 96 D1 82 2C 20 68 65 6C 6C 6F    Ð¸Ð²ÑÑ, hello "
            )
        }
    }

    Context 'When expected and actual value contain escaped characters' {
        It 'Should output to console' {
            $expected = "escaped characters: `0 `a `b `f `n `r `t"
            $actual = "escaped characters: `0 `a `b `f `n `r `t"

            $result = Out-Difference -Reference $expected -Difference $actual

            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Bytes                                           Ascii                   Bytes                                           Ascii"
                "-----                                           -----                   -----                                           -----"
                "65 73 63 61 70 65 64 20 63 68 61 72 61 63 74 65 escaped characte   ==   65 73 63 61 70 65 64 20 63 68 61 72 61 63 74 65 escaped characte"
                "72 73 3A 20 00 20 07 20 08 20 0C 20 0A 20 0D 20 rs: ␀ ␇ ␈ ␌ ␊ ␍    ==   72 73 3A 20 00 20 07 20 08 20 0C 20 0A 20 0D 20 rs: ␀ ␇ ␈ ␌ ␊ ␍ "
                "09                                              ␉                  ==   09                                              ␉               "
            )
        }
    }

    Context 'When NoHexOutput is specified' {
        It 'Should output only ascii character groups without hex columns' {
            $longStr = 'A' * 70
            $result = Out-Difference -Reference $longStr -Difference $longStr -NoHexOutput
            $result | Should-BeBlockString @(
                "Expected:$([System.Char] 0x1b)[0m                                                               But was:$([System.Char] 0x1b)[0m"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "Ascii                                                                   Ascii"
                "----------------------------------------------------------------        ----------------------------------------------------------------"
                "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   ==   AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                "AAAAAA                                                             ==   AAAAAA                                                          "
            )
        }
    }

    # cSpell: enable
}
